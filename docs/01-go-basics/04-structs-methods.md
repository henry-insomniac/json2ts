# ğŸ—ï¸ ç»“æ„ä½“å’Œæ–¹æ³• - Go çš„é¢å‘å¯¹è±¡

> æœ¬ç« è§£é‡Šæˆ‘ä»¬åœ¨ç±»å‹æ¨æ–­æ”¹è¿›ä¸­ç”¨åˆ°çš„æ ¸å¿ƒæ¦‚å¿µ

## ğŸ¯ ä»€ä¹ˆæ˜¯ç»“æ„ä½“ï¼ˆStructï¼‰ï¼Ÿ

**ç»“æ„ä½“**æ˜¯ Go ä¸­ç»„ç»‡æ•°æ®çš„æ–¹å¼ï¼Œç±»ä¼¼å…¶ä»–è¯­è¨€ä¸­çš„"ç±»"ï¼Œä½†æ›´ç®€å•ï¼š

```go
// å®šä¹‰ä¸€ä¸ªç»“æ„ä½“
type Person struct {
    Name string    // å§“åå­—æ®µ
    Age  int       // å¹´é¾„å­—æ®µ
}

// åˆ›å»ºç»“æ„ä½“å®ä¾‹
var p Person
p.Name = "å¼ ä¸‰"
p.Age = 25

// æˆ–è€…ä½¿ç”¨å­—é¢é‡åˆ›å»º
p2 := Person{
    Name: "æå››",
    Age:  30,
}
```

## ğŸ”§ æˆ‘ä»¬é¡¹ç›®ä¸­çš„ TypeGenerator ç»“æ„ä½“

è®©æˆ‘ä»¬åˆ†ææˆ‘ä»¬æ”¹è¿›ä»£ç ä¸­ä½¿ç”¨çš„ç»“æ„ä½“ï¼š

```go
// TypeGenerator ç»“æ„ä½“ç”¨äºç”Ÿæˆ TypeScript ç±»å‹
type TypeGenerator struct {
    interfaces       []string  // å­˜å‚¨ç”Ÿæˆçš„æ¥å£
    interfaceCounter int       // æ¥å£è®¡æ•°å™¨
}
```

### ä¸ºä»€ä¹ˆè¦ç”¨ç»“æ„ä½“ï¼Ÿ

**æ”¹è¿›å‰**ï¼ˆåªæœ‰å‡½æ•°ï¼‰ï¼š
```go
func toTSType(val interface{}) string {
    // é—®é¢˜ï¼šæ— æ³•ä¿å­˜çŠ¶æ€ï¼Œä¸èƒ½ç”Ÿæˆå¤šä¸ªæ¥å£
    return "simple type"
}
```

**æ”¹è¿›å**ï¼ˆä½¿ç”¨ç»“æ„ä½“ï¼‰ï¼š
```go
type TypeGenerator struct {
    interfaces       []string  // ä¿å­˜æ‰€æœ‰ç”Ÿæˆçš„æ¥å£
    interfaceCounter int       // è®°å½•ç”Ÿæˆäº†å‡ ä¸ªæ¥å£
}
```

### ç»“æ„ä½“çš„ä¼˜åŠ¿ï¼š
1. **çŠ¶æ€ä¿æŒ**ï¼šå¯ä»¥è®°ä½ä¹‹å‰ç”Ÿæˆçš„æ¥å£
2. **æ•°æ®ç»„ç»‡**ï¼šç›¸å…³çš„æ•°æ®æ”¾åœ¨ä¸€èµ·
3. **æ–¹æ³•ç»‘å®š**ï¼šå¯ä»¥ç»™ç»“æ„ä½“æ·»åŠ æ–¹æ³•

## ğŸ­ ä»€ä¹ˆæ˜¯æ–¹æ³•ï¼ˆMethodï¼‰ï¼Ÿ

**æ–¹æ³•**å°±æ˜¯ç»‘å®šåˆ°ç»“æ„ä½“ä¸Šçš„å‡½æ•°ï¼š

```go
// æ™®é€šå‡½æ•°
func greet(name string) {
    fmt.Printf("Hello, %s!\n", name)
}

// æ–¹æ³•ï¼šç»‘å®šåˆ° Person ç»“æ„ä½“
func (p Person) greet() {
    fmt.Printf("Hello, I'm %s!\n", p.Name)
}

// ä½¿ç”¨æ–¹æ³•
person := Person{Name: "ç‹äº”"}
person.greet()  // è¾“å‡ºï¼šHello, I'm ç‹äº”!
```

## ğŸ” æ–¹æ³•æ¥æ”¶å™¨è¯¦è§£

### å€¼æ¥æ”¶å™¨ vs æŒ‡é’ˆæ¥æ”¶å™¨

è¿™æ˜¯ Go ä¸­éå¸¸é‡è¦çš„æ¦‚å¿µï¼š

```go
// å€¼æ¥æ”¶å™¨ï¼šæ¥æ”¶ç»“æ„ä½“çš„å‰¯æœ¬
func (p Person) getValue() string {
    return p.Name  // åªèƒ½è¯»å–ï¼Œä¸èƒ½ä¿®æ”¹åŸå§‹æ•°æ®
}

// æŒ‡é’ˆæ¥æ”¶å™¨ï¼šæ¥æ”¶ç»“æ„ä½“çš„åœ°å€
func (p *Person) setValue(name string) {
    p.Name = name  // å¯ä»¥ä¿®æ”¹åŸå§‹æ•°æ®
}
```

### åœ¨æˆ‘ä»¬é¡¹ç›®ä¸­çš„åº”ç”¨

```go
// æˆ‘ä»¬ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨ï¼Œå› ä¸ºéœ€è¦ä¿®æ”¹ç»“æ„ä½“çš„çŠ¶æ€
func (tg *TypeGenerator) generateInterface(name string, obj map[string]interface{}) string {
    // tg æ˜¯æŒ‡å‘ TypeGenerator çš„æŒ‡é’ˆ
    // æˆ‘ä»¬éœ€è¦ä¿®æ”¹ tg.interfaces å’Œ tg.interfaceCounter
    
    // ç”Ÿæˆæ¥å£å¹¶æ·»åŠ åˆ° interfaces åˆ‡ç‰‡ä¸­
    interfaceDef := fmt.Sprintf("export interface %s {...}", name)
    tg.interfaces = append(tg.interfaces, interfaceDef)  // ä¿®æ”¹ç»“æ„ä½“çŠ¶æ€
    tg.interfaceCounter++                                 // ä¿®æ”¹è®¡æ•°å™¨
    
    return name
}
```

### ä¸ºä»€ä¹ˆä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨ï¼Ÿ

1. **ä¿®æ”¹åŸå§‹æ•°æ®**ï¼šæˆ‘ä»¬éœ€è¦å‘ `interfaces` åˆ‡ç‰‡æ·»åŠ æ–°æ¥å£
2. **æ€§èƒ½è€ƒè™‘**ï¼šé¿å…å¤åˆ¶æ•´ä¸ªç»“æ„ä½“
3. **ä¸€è‡´æ€§**ï¼šå¦‚æœæœ‰ä¸€ä¸ªæ–¹æ³•ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨ï¼Œé€šå¸¸æ‰€æœ‰æ–¹æ³•éƒ½ç”¨æŒ‡é’ˆæ¥æ”¶å™¨

## ğŸ­ æ„é€ å‡½æ•°æ¨¡å¼

Go æ²¡æœ‰æ„é€ å‡½æ•°ï¼Œä½†æˆ‘ä»¬å¯ä»¥åˆ›å»º"æ„é€ å‡½æ•°"ï¼š

```go
// NewTypeGenerator åˆ›å»ºæ–°çš„ç±»å‹ç”Ÿæˆå™¨ï¼ˆæ„é€ å‡½æ•°æ¨¡å¼ï¼‰
func NewTypeGenerator() *TypeGenerator {
    return &TypeGenerator{
        interfaces:       make([]string, 0),  // åˆå§‹åŒ–ç©ºåˆ‡ç‰‡
        interfaceCounter: 0,                   // è®¡æ•°å™¨ä» 0 å¼€å§‹
    }
}

// ä½¿ç”¨æ–¹å¼
generator := NewTypeGenerator()
```

### æ„é€ å‡½æ•°çš„å¥½å¤„ï¼š
1. **åˆå§‹åŒ–æ§åˆ¶**ï¼šç¡®ä¿ç»“æ„ä½“æ­£ç¡®åˆå§‹åŒ–
2. **é»˜è®¤å€¼è®¾ç½®**ï¼šä¸ºå­—æ®µè®¾ç½®åˆç†çš„é»˜è®¤å€¼
3. **ä»£ç æ¸…æ™°**ï¼šä¸€çœ¼å°±èƒ½çœ‹å‡ºå¦‚ä½•åˆ›å»ºå¯¹è±¡

## ğŸ¨ æ–¹æ³•é“¾å’Œæµå¼æ¥å£

æˆ‘ä»¬å¯ä»¥è®©æ–¹æ³•è¿”å›ç»“æ„ä½“æœ¬èº«ï¼Œå®ç°é“¾å¼è°ƒç”¨ï¼š

```go
func (tg *TypeGenerator) addInterface(def string) *TypeGenerator {
    tg.interfaces = append(tg.interfaces, def)
    return tg  // è¿”å›è‡ªèº«ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨
}

// é“¾å¼è°ƒç”¨
generator.addInterface("interface A {}").addInterface("interface B {}")
```

## ğŸ§© å®é™…ä»£ç åˆ†æ

è®©æˆ‘ä»¬åˆ†ææˆ‘ä»¬é¡¹ç›®ä¸­çš„å®Œæ•´æ–¹æ³•ï¼š

```go
// handleObject å¤„ç†å¯¹è±¡ç±»å‹æ¨æ–­
func (tg *TypeGenerator) handleObject(obj map[string]interface{}) string {
    // 1. ç”Ÿæˆæ¥å£å
    tg.interfaceCounter++
    interfaceName := fmt.Sprintf("Interface%d", tg.interfaceCounter)
    
    // 2. ç”Ÿæˆæ¥å£å®šä¹‰
    return tg.generateInterface(interfaceName, obj)
}
```

**æ­¥éª¤è§£æ**ï¼š
1. **ä¿®æ”¹è®¡æ•°å™¨**ï¼š`tg.interfaceCounter++`
2. **ç”Ÿæˆå”¯ä¸€åç§°**ï¼š`Interface1`, `Interface2`, ...
3. **è°ƒç”¨å…¶ä»–æ–¹æ³•**ï¼š`tg.generateInterface(...)`
4. **è¿”å›æ¥å£å**ï¼šç”¨äºå¼•ç”¨è¿™ä¸ªæ¥å£

## ğŸ”„ æ–¹æ³•ä¹‹é—´çš„åä½œ

```go
func (tg *TypeGenerator) toTSType(val interface{}) string {
    switch v := val.(type) {
    case map[string]interface{}:
        return tg.handleObject(v)     // è°ƒç”¨å…¶ä»–æ–¹æ³•
    case []interface{}:
        return tg.handleArray(v)      // è°ƒç”¨å…¶ä»–æ–¹æ³•
    default:
        return "simple type"
    }
}
```

### æ–¹æ³•åä½œçš„å¥½å¤„ï¼š
1. **èŒè´£åˆ†ç¦»**ï¼šæ¯ä¸ªæ–¹æ³•åªåšä¸€ä»¶äº‹
2. **ä»£ç å¤ç”¨**ï¼šæ–¹æ³•å¯ä»¥äº’ç›¸è°ƒç”¨
3. **æ˜“äºæµ‹è¯•**ï¼šå¯ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸ªæ–¹æ³•
4. **æ˜“äºç»´æŠ¤**ï¼šä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½åªéœ€è¦æ”¹å¯¹åº”çš„æ–¹æ³•

## ğŸ¯ å®è·µå»ºè®®

### 1. ä½•æ—¶ä½¿ç”¨ç»“æ„ä½“ï¼Ÿ
- éœ€è¦**ç»„ç»‡ç›¸å…³æ•°æ®**æ—¶
- éœ€è¦**ä¿æŒçŠ¶æ€**æ—¶
- éœ€è¦ç»™æ•°æ®**æ·»åŠ è¡Œä¸º**æ—¶

### 2. ä½•æ—¶ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨ï¼Ÿ
- éœ€è¦**ä¿®æ”¹ç»“æ„ä½“**æ—¶
- ç»“æ„ä½“**æ¯”è¾ƒå¤§**æ—¶ï¼ˆæ€§èƒ½è€ƒè™‘ï¼‰
- éœ€è¦**ä¸€è‡´æ€§**æ—¶

### 3. æ–¹æ³•è®¾è®¡åŸåˆ™
- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªæ–¹æ³•åªåšä¸€ä»¶äº‹
- **æ¸…æ™°å‘½å**ï¼šæ–¹æ³•åè¦è¯´æ˜å®ƒçš„åŠŸèƒ½
- **åˆç†è¿”å›**ï¼šè¿”å›è°ƒç”¨è€…éœ€è¦çš„ä¿¡æ¯

## ğŸ’¡ ä¸å…¶ä»–è¯­è¨€å¯¹æ¯”

| æ¦‚å¿µ | Go | Java/C# | Python |
|------|----|---------| -------|
| æ•°æ®ç»„ç»‡ | struct | class | class |
| æ–¹æ³•ç»‘å®š | æ¥æ”¶å™¨ | ç±»æ–¹æ³• | ç±»æ–¹æ³• |
| æ„é€ å‡½æ•° | Newå‡½æ•° | constructor | __init__ |
| ç»§æ‰¿ | ç»„åˆ | extends | extends |

## ğŸ¯ å°ç»“

é€šè¿‡ç»“æ„ä½“å’Œæ–¹æ³•ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š

1. **çŠ¶æ€ä¿æŒ**ï¼šTypeGenerator è®°ä½ç”Ÿæˆçš„æ‰€æœ‰æ¥å£
2. **ä»£ç ç»„ç»‡**ï¼šç›¸å…³åŠŸèƒ½ç»„ç»‡åœ¨ä¸€èµ·
3. **é€’å½’å¤„ç†**ï¼šæ–¹æ³•å¯ä»¥è°ƒç”¨å…¶ä»–æ–¹æ³•å¤„ç†å¤æ‚ç»“æ„
4. **æ‰©å±•æ€§**ï¼šå®¹æ˜“æ·»åŠ æ–°çš„ç±»å‹å¤„ç†é€»è¾‘

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„ç±»å‹æ¨æ–­å¼•æ“å˜å¾—æ›´å¼ºå¤§äº†ï¼

---

**ä¸‹ä¸€ç« **ï¼š[åˆ‡ç‰‡å’Œæ˜ å°„è¯¦è§£](05-slices-maps.md) ğŸš€